<script id="retrieveImage">
    var ImgName, ImgUrl;
    var files = [];
    var reader = new FileReader();

    var firebaseConfig = {
        apiKey: "AIzaSyAQDU7-hbWtI3sa3s3woi4YfUJtiVRYhGg",
        authDomain: "fbeye-bf2f1.firebaseapp.com",
        databaseURL: "https://fbeye-bf2f1-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "fbeye-bf2f1",
        storageBucket: "fbeye-bf2f1.appspot.com",
        messagingSenderId: "462631567055",
        appId: "1:462631567055:web:bc8ee774e09e56e8fcc1ba",
        measurementId: "G-83NWPL2V92"
    };
    
    firebase.initializeApp(firebaseConfig);

    /* Select photo from file explorer */
    document.getElementById("select").onclick = function(e){

        /* Opens up file explorer to allow user to select photo to upload */
        var input = document.getElementById('input');
        input.type='file';

        input.onchange = e => {
            files = e.target.files;
            reader = new FileReader();
            reader.onload = function(){
                document.getElementById("Image").src = reader.result;
            }
            reader.readAsDataURL(files[0]);
        }
        input.click();

    }

    /* Upload selected photo to firebase */
    document.getElementById("upload").onclick = function(){
        ImgName = document.getElementById('namebox').value;
        var upload = firebase.storage().ref('Images/'+ImgName+".png").put(files[0]);

            upload.on('state_changed', function(snapshot){
                var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                document.getElementById('progress').innerHTML = 'Upload'+progress+'%';

            },
        
            function(error){
                alert('Error in saving the image');
            },

            function(){
                upload.snapshot.ref.getDownloadURL().then(function(url){
                    ImgUrl = url;

                firebase.database().ref('Pictures/'+ImgName).set({
                    Name: ImgName,
                    Link: ImgURL
                });
                alert('Image Added Sucessfully!');
                }

            );

        });
    }

    /* Retrieve Image from Database  */
    document.getElementById('retrieve').onclick = function(){
        ImgName = document.getElementById('namebox').value;
        firebase.database().ref('Pictures/'+ImgName).on('value', function(snapshot){
            document.getElementById('Image').src = snapshot.val().Link;
        });
    }

      
</script>